*cd /vabhomerun/vab. ./.profileexport SERVERNAME=RSPWDmsg=`/vab/bin/sendresource_aix dmzftp FTP_0015`rc=$?if [ "$rc" -ne "0" ]; then   echo $msg   exitfiacc=`echo $msg | cut -d, -f2`#做FTPHOSTIP=172.16.1.68OUTFILE=/vab/tmp/Ftp_$1$$DMZFTP_DIR=$1LOCALDIR_CON=/vab/b2bank/report/$1/downYEAR=`date +"%Y"`MON=`date +"%m"`DAY=`date +"%d"`# Add 0 to month. This is a# trick to make month an unpadded integer.MON=`expr $MON + 0`# Subtract one from the current day.DAY=`expr $DAY - 1`if [ $DAY -eq 0 ]; thenMON=`expr $MON - 1`if [ $MON -eq 0 ]; then   MON=12   DAY=31   YEAR=`expr $YEAR - 1`else   case $MON in     1|3|5|7|8|10|12) DAY=31;;     4|6|9|11) DAY=30;;     2)       if [ `expr $YEAR % 4` -eq 0 ]; then         if [ `expr $YEAR % 400` -eq 0 ]; then           DAY=29         elif [ `expr $YEAR % 100` -eq 0 ]; then           DAY=28         else           DAY=29         fi       else         DAY=28       fi     ;;   esacfifiif [ $MON -lt 10 ]; then MON=0$MONfiif [ $DAY -lt 10 ]; then DAY=0$DAYfifunction first_day{print $YEAR$MON$DAY}FIRST_DAY=$(first_day)DoFTP(){set -xftp -i -n -v ${HOSTIP}  <<! 1>${OUTFILE} 2>&1user $accbinarycd ${DMZFTP_DIR}lcd ${LOCALDIR_CON}verbose 1debug 1prompt offmget *$FIRST_DAY!set +xreturn}DoChkFTP(){   # if success then ftp reply "226 Transfer complete."   if [ "$1" = "226" ]   then       TFLAG=1   fi}ChkFTP(){   TFLAG=0   while read line   do       DoChkFTP ${line}   done   return ${TFLAG}}#Mainset -xDoFTP ${FILE1}ChkFTP   < ${OUTFILE}
